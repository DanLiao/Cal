# Swift计算器使用说明

## 1. 启动计算器

双击`Cal.app`即可启动计算器。计算器将在终端窗口中运行。

您也可以使用测试脚本：
```
./run_test.sh             # 交互式使用计算器
./run_test.sh "表达式"     # 直接计算表达式
```

## 2. 基本运算

计算器支持以下基本运算：

```
>>> 1+2      # 加法
3
>>> 5-3      # 减法
2
>>> 4*5      # 乘法
20
>>> 10/2     # 除法
5
```

### 2.1 浮点数格式

计算器支持多种浮点数格式：

```
>>> 3.14     # 标准格式
3.14
>>> 2.       # 小数点后没有数字
2.0
>>> .5       # 小数点前没有数字
0.5
>>> 1+.25    # 表达式中使用
1.25
```

## 3. 高级功能

### 3.1 特殊函数

```
>>> sqrt(16)   # 平方根
4
>>> pow(2,3)   # 幂运算
8
>>> log(10)    # 对数
2.302585092994046
>>> sin(0)     # 正弦
0
>>> cos(0)     # 余弦
1
>>> tan(0)     # 正切
0
```

### 3.2 数学常量

```
>>> pi         # 圆周率
3.141592653589793
>>> e          # 自然常数
2.718281828459045
```

### 3.3 使用上次计算结果

```
>>> 2+2
4
>>> ans*2      # 使用上次结果(4)乘以2
8
```

## 4. 命令

计算器支持以下命令：

- `help` 或 `h` 或 `?` - 显示帮助信息
- `clear` 或 `cls` - 清除屏幕
- `history` - 显示计算历史
- `record` - 将计算历史保存到文件中
- `ans` - 显示上一次计算结果
- `q` 或 `quit` 或 `exit` - 退出计算器

## 5. 错误检查与提示

计算器具备强大的错误检查功能，能够高亮显示错误位置并提供修正建议：

### 5.1 无效字符

```
>>> 2+3?
错误：无效字符 '?'
2+3?
   ^
建议：请移除无效字符或替换为有效字符
```

### 5.2 括号不匹配

```
>>> (2+3
错误：缺少右括号
(2+3
^
建议：请在适当位置添加)括号
```

### 5.3 无效运算符

```
>>> 2++3
错误：无效运算符 '++'
2++3
 ^^
建议：运算符不能连续使用，请检查并修正
有效的运算符：+, -, *, /
```

### 5.4 函数调用错误

```
>>> pow(2)
错误：无效函数调用 'pow需要两个参数，以逗号分隔'
pow(2)
^^^
建议：请检查函数名及参数格式
支持的函数：sqrt(x), pow(x,y), log(x), sin(x), cos(x), tan(x)
```

## 6. 历史记录

所有计算历史将自动保存在计算器的内存中，使用`history`命令可以查看。

如需保存历史记录到文件，可使用`record`命令。文件将保存在`record`目录中，文件名格式为：`yyyyMMdd_HHmm.txt`。 